<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K Edu - Learn Through Videos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2a5298;
            --accent-color: #ff4757;
            --text-color: #333;
            --background-color: #fff;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
        }

        .header {
            background: linear-gradient(135deg, #1e3c72, var(--primary-color));
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: white;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--accent-color);
        }

        .auth-section {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-secondary {
            background-color: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .search-section {
            background-color: #f8f9fa;
            padding: 2rem 0;
            border-bottom: 1px solid #e9ecef;
        }

        .search-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            text-align: center;
            position: relative;
        }

        .search-box {
            display: flex;
            max-width: 600px;
            margin: 0 auto;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 25px;
            overflow: hidden;
        }

        .search-input {
            flex: 1;
            padding: 1rem 1.5rem;
            border: none;
            font-size: 1rem;
            outline: none;
        }

        .search-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-size: 1rem;
        }

        .loader {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .hero {
            text-align: center;
            padding: 3rem 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            margin-bottom: 3rem;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .category-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .category-card:hover {
            transform: translateY(-5px);
        }

        .category-header {
            background: linear-gradient(135deg, var(--accent-color), #ff3742);
            color: white;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
        }

        .category-header h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .videos-container {
            display: none;
            padding: 1.5rem;
        }

        .videos-container.active {
            display: block;
        }

        .video-item {
            margin-bottom: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .video-item:hover {
            background-color: #e9ecef;
        }

        .video-item img {
            width: 120px;
            height: 90px;
            object-fit: cover;
            border-radius: 5px;
        }

        .video-item h4 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .video-item p {
            font-size: 0.9rem;
            color: #666;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 10px;
            width: 80%;
            max-width: 800px;
            position: relative;
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: var(--accent-color);
        }

        .admin-panel {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .admin-form {
            display: grid;
            gap: 1rem;
            max-width: 500px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .about-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .about-content h2 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 0.5rem;
        }

        .about-content p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .staff-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .staff-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 2rem;
            text-align: center;
        }

        .staff-avatar {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            border-radius: 50%;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .categories-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
            }

            .video-item {
                flex-direction: column;
                text-align: center;
            }

            .video-item img {
                width: 100%;
                max-width: 200px;
            }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="nav-container">
            <div class="logo">K Edu</div>
            <nav>
                <ul class="nav-links">
                    <li><a href="#" onclick="showPage('home')">Home</a></li>
                    <li><a href="#" onclick="showPage('about')">About</a></li>
                    <li><a href="#" onclick="showPage('contact')">Contact</a></li>
                    <li><a href="#" onclick="showPage('staff')">Staff</a></li>
                </ul>
            </nav>
            <div class="auth-section">
                <button class="btn btn-secondary" id="loginBtn" onclick="showLogin()">Login</button>
                <button class="btn btn-primary hidden" id="logoutBtn" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>

    <section class="search-section">
        <div class="search-container">
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="Search for videos...">
                <button class="search-btn" onclick="searchVideos()">Search</button>
            </div>
            <div class="loader" id="searchLoader"></div>
        </div>
    </section>

    <main class="main-content">
        <div id="home" class="page active">
            <div class="hero">
                <h1>Welcome to K Edu</h1>
                <p>Discover knowledge through carefully curated YouTube videos. Learn at your own pace with our organized educational content.</p>
            </div>

            <div id="categoriesContainer" class="categories-grid">
                <div class="loader" id="categoriesLoader"></div>
            </div>

            <div id="adminPanel" class="admin-panel hidden">
                <h2>Admin Panel</h2>
                <div class="admin-form">
                    <h3>Add New Category</h3>
                    <div class="form-group">
                        <label for="categoryName">Category Name:</label>
                        <input type="text" id="categoryName" placeholder="e.g., Mathematics">
                    </div>
                    <div class="form-group">
                        <label for="categoryDesc">Category Description:</label>
                        <textarea id="categoryDesc" placeholder="Brief description of the category"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="addCategory()">Add Category</button>
                </div>

                <div class="admin-form" style="margin-top: 2rem;">
                    <h3>Add New Video</h3>
                    <div class="form-group">
                        <label for="videoCategory">Select Category:</label>
                        <select id="videoCategory">
                            <option value="">Choose a category...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="videoTitle">Video Title:</label>
                        <input type="text" id="videoTitle" placeholder="Enter video title">
                    </div>
                    <div class="form-group">
                        <label for="videoUrl">YouTube URL:</label>
                        <input type="url" id="videoUrl" placeholder="https://www.youtube.com/watch?v=...">
                    </div>
                    <div class="form-group">
                        <label for="videoDesc">Video Description:</label>
                        <textarea id="videoDesc" placeholder="Brief description of the video"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="addVideo()">Add Video</button>
                </div>
            </div>
        </div>

        <div id="about" class="page">
            <div class="about-content">
                <h2>About K Edu</h2>
                <p><strong>What K Edu Does:</strong> K Edu is a comprehensive educational platform that provides access to carefully curated YouTube videos across various subjects. We organize educational content into logical categories, making it easy for students to find and learn from high-quality video resources.</p>
                <h2>Why We Created K Edu</h2>
                <p>In today's digital age, YouTube has become one of the largest repositories of educational content. However, finding quality educational videos can be overwhelming due to the vast amount of content available. K Edu was created to solve this problem by providing a curated, organized platform where students can access the best educational videos without the distraction of irrelevant content.</p>
                <h2>How K Edu Helps Students</h2>
                <p><strong>Organized Learning:</strong> Our platform categorizes videos by subject, making it easy to find relevant content for your studies.</p>
                <p><strong>Quality Assurance:</strong> All videos are reviewed by our educational staff to ensure they meet high standards for accuracy and teaching quality.</p>
                <p><strong>Easy Search:</strong> Our powerful search functionality helps you quickly find videos on specific topics.</p>
                <p><strong>Free Access:</strong> All content is freely available to students, removing barriers to quality education.</p>
                <p><strong>Mobile Friendly:</strong> Access your learning materials anywhere, anytime, on any device.</p>
            </div>
        </div>

        <div id="contact" class="page">
            <div class="about-content">
                <h2>Contact Us</h2>
                <p>We'd love to hear from you! Whether you have questions, suggestions, or need support, don't hesitate to reach out.</p>
                <div style="margin-top: 2rem;">
                    <h3>Get in Touch</h3>
                    <p><strong>Email:</strong> dmkaawya@gmail.com</p>
                    <p><strong>Phone:</strong> +94 077 50 48 455</p>
                    <p><strong>Address:</strong> Kalutara south, Kalutara, Western Province, Sri Lanka</p>
                </div>
                <div style="margin-top: 2rem;">
                    <h3>Support Hours</h3>
                    <p>Monday - Friday: 9:00 AM - 6:00 PM</p>
                    <p>Saturday: 10:00 AM - 4:00 PM</p>
                    <p>Sunday: Closed</p>
                </div>
                <div style="margin-top: 2rem;">
                    <h3>For Educators</h3>
                    <p>Interested in contributing to our platform? Contact us at <strong>dmkaawya@gmail.com</strong> to learn about becoming a content curator.</p>
                </div>
            </div>
        </div>

        <div id="staff" class="page">
            <div class="about-content">
                <h2>Our Team</h2>
                <p>Meet the dedicated educators and administrators who make K Edu possible.</p>
                <div class="staff-grid" style="margin-top: 2rem;">
                    <div class="staff-card">
                        <div class="staff-avatar" aria-label="Avatar for Dr. Jane Doe">JD</div>
                        <h3>D.M.C.Kaawya Chandrasekara</h3>
                        <p><strong>Chief Education Officer</strong></p>
                        <p>Certificates in web devoloper with 4 years of experience in Basic web development.</p>
                    </div>
                    <div class="staff-card">
                        <div class="staff-avatar" aria-label="Avatar for Prof. Mike Smith">MS</div>
                        <h3>Sandeepa lakshan</h3>
                        <p><strong>Platform Administrator</strong></p>
                        <p>Diploma in Web devoloper with 6 years of exprience in Exprect web development</p>
                    </div>
                </div>
                <div style="margin-top: 3rem; padding: 2rem; background: #f8f9fa; border-radius: 10px;">
                    <h3>Staff Login</h3>
                    <p>Staff members can log in to access administrative features including adding new categories and video content.</p>
                    <button class="btn btn-primary" onclick="showLogin()">Staff Login</button>
                </div>
            </div>
        </div>
    </main>

    <div id="videoModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="videoContainer"></div>
            <h3 id="videoTitle"></h3>
            <p id="videoDescription"></p>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Staff Login</h2>
            <div class="admin-form">
                <div class="form-group">
                    <label for="username">Username:</label>
                    <input type="text" id="username" placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" placeholder="Enter password">
                </div>
                <button class="btn btn-primary" onclick="login()">Login</button>
            </div>
        </div>
    </div>

    <script>
        let isLoggedIn = false;
        let currentPage = 'home';
        let token = null;

        function init() {
            console.log('Initializing K Edu website');
            loadCategories();
            setupEventListeners();
        }

        function setupEventListeners() {
            console.log('Setting up event listeners');
            document.querySelectorAll('.close').forEach(closeBtn => {
                closeBtn.onclick = function() {
                    closeBtn.closest('.modal').style.display = 'none';
                }
            });

            window.onclick = function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            }

            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchVideos();
                }
            });

            document.getElementById('categoriesContainer').addEventListener('click', (e) => {
                const videoItem = e.target.closest('.video-item');
                if (videoItem) {
                    const url = videoItem.dataset.url;
                    const title = videoItem.dataset.title;
                    const description = videoItem.dataset.description;
                    playVideo(url, title, description);
                }
            });
        }

        function showPage(pageId) {
            console.log('Showing page:', pageId);
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            currentPage = pageId;
        }

        async function loadCategories() {
            const container = document.getElementById('categoriesContainer');
            const videoCategorySelect = document.getElementById('videoCategory');
            const loader = document.getElementById('categoriesLoader');
            
            console.log('Loading categories');
            loader.style.display = 'block';
            container.innerHTML = '';

            try {
                const response = await fetch('http://localhost:3000/api/categories');
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                const categories = await response.json();
                console.log('Categories fetched:', categories);

                videoCategorySelect.innerHTML = '<option value="">Choose a category...</option>';

                categories.forEach(category => {
                    const categoryCard = document.createElement('div');
                    categoryCard.className = 'category-card';
                    const shortDesc = category.description.length > 100 ? category.description.substring(0, 100) + '...' : category.description;
                    categoryCard.innerHTML = `
                        <div class="category-header" onclick="toggleVideos(this)">
                            <h3>${category.name}</h3>
                            <p>${shortDesc}</p>
                        </div>
                        <div class="videos-container">
                            ${category.videos.map(video => {
                                const videoId = video.url.split('/').pop();
                                const shortDesc = video.description.length > 100 ? video.description.substring(0, 100) + '...' : video.description;
                                return `
                                    <div class="video-item" data-url="${video.url}" data-title="${video.title}" data-description="${video.description}">
                                        <img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title} thumbnail">
                                        <div>
                                            <h4>${video.title}</h4>
                                            <p>${shortDesc}</p>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                    container.appendChild(categoryCard);

                    const option = document.createElement('option');
                    option.value = category.id;
                    option.textContent = category.name;
                    videoCategorySelect.appendChild(option);
                });

                loader.style.display = 'none';
            } catch (err) {
                console.error('Error loading categories:', err);
                container.innerHTML = '<p style="text-align: center; color: #666;">Error loading categories. Please try again later.</p>';
                container.innerHTML = '<p style="text-align: center; color: #666;">If it doesn't work, try logging in Username - admin, Password - admin123.</p>';
                container.innerHTML = '<p style="text-align: center; color: #666;">But if it doesn't work, contact us from the Contact tab.dmkaawya@gmail.com.</p>';
                loader.style.display = 'none';
            }
        }

        function toggleVideos(header) {
            console.log('Toggling videos for category');
            const videosContainer = header.nextElementSibling;
            videosContainer.classList.toggle('active');
        }

        function playVideo(url, title, description) {
            console.log('Playing video:', title);
            const modal = document.getElementById('videoModal');
            const videoContainer = document.getElementById('videoContainer');
            const videoTitle = document.getElementById('videoTitle');
            const videoDescription = document.getElementById('videoDescription');

            videoContainer.innerHTML = `<iframe width="100%" height="400" src="${url}" frameborder="0" allowfullscreen sandbox="allow-scripts allow-same-origin"></iframe>`;
            videoTitle.textContent = title;
            videoDescription.textContent = description;
            modal.style.display = 'block';

            const iframe = videoContainer.querySelector('iframe');
            iframe.addEventListener('contextmenu', (e) => e.preventDefault());
        }

        async function searchVideos() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const container = document.getElementById('categoriesContainer');
            const loader = document.getElementById('searchLoader');
            
            if (!searchTerm) {
                alert('Please enter a search term.');
                return;
            }

            console.log('Searching videos with term:', searchTerm);
            loader.style.display = 'block';
            container.innerHTML = '';

            try {
                const response = await fetch('http://localhost:3000/api/categories');
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                const categories = await response.json();

                const results = [];
                categories.forEach(category => {
                    category.videos.forEach(video => {
                        if (video.title.toLowerCase().includes(searchTerm) || 
                            video.description.toLowerCase().includes(searchTerm)) {
                            results.push({...video, category: category.name});
                        }
                    });
                });

                if (results.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #666; font-size: 1.2rem;">No videos found for your search.</p>';
                    loader.style.display = 'none';
                    return;
                }

                const resultsCard = document.createElement('div');
                resultsCard.className = 'category-card';
                resultsCard.innerHTML = `
                    <div class="category-header">
                        <h3>Search Results (${results.length})</h3>
                        <p>Videos matching "${searchTerm}"</p>
                    </div>
                    <div class="videos-container active">
                        ${results.map(video => {
                            const videoId = video.url.split('/').pop();
                            const shortDesc = video.description.length > 100 ? video.description.substring(0, 100) + '...' : video.description;
                            return `
                                <div class="video-item" data-url="${video.url}" data-title="${video.title}" data-description="${video.description}">
                                    <img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="${video.title} thumbnail">
                                    <div>
                                        <h4>${video.title}</h4>
                                        <p><strong>Category:</strong> ${video.category}</p>
                                        <p>${shortDesc}</p>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                container.appendChild(resultsCard);

                const clearBtn = document.createElement('button');
                clearBtn.className = 'btn btn-secondary';
                clearBtn.textContent = 'Clear Search';
                clearBtn.style.margin = '1rem auto';
                clearBtn.style.display = 'block';
                clearBtn.onclick = () => {
                    document.getElementById('searchInput').value = '';
                    loadCategories();
                };
                container.appendChild(clearBtn);

                loader.style.display = 'none';
            } catch (err) {
                console.error('Error searching videos:', err);
                container.innerHTML = '<p style="text-align: center; color: #666;">Error searching videos. Please try again later.</p>';
                container.innerHTML = '<p style="text-align: center; color: #666;">If it doesn't work, try logging in Username - admin, Password - admin123.</p>';
                container.innerHTML = '<p style="text-align: center; color: #666;">But if it doesn't work, contact us from the Contact tab.dmkaawya@gmail.com.</p>';
                loader.style.display = 'none';
                
            }
        }

        function showLogin() {
            console.log('Showing login modal');
            document.getElementById('loginModal').style.display = 'block';
        }

        async function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!username || !password) {
                alert('Please enter both username and password.');
                return;
            }

            console.log('Attempting login for:', username);
            try {
                const response = await fetch('http://localhost:3000/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });
                const data = await response.json();

                if (response.ok) {
                    isLoggedIn = true;
                    token = data.token;
                    console.log('Login successful, token:', token.substring(0, 10) + '...');
                    document.getElementById('loginBtn').classList.add('hidden');
                    document.getElementById('logoutBtn').classList.remove('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                    document.getElementById('loginModal').style.display = 'none';
                    document.getElementById('username').value = '';
                    document.getElementById('password').value = '';
                    alert('Login successful! You can now add categories and videos.');
                } else {
                    console.log('Login failed:', data.message);
                    alert(data.message || 'Invalid credentials. Please try again.');
                }
            } catch (err) {
                console.error('Login error:', err);
                alert('Login failed. Please check your connection and try again.');
            }
        }

        function logout() {
            console.log('Logging out');
            isLoggedIn = false;
            token = null;
            document.getElementById('loginBtn').classList.remove('hidden');
            document.getElementById('logoutBtn').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            alert('Logged out successfully!');
        }

        async function addCategory() {
            if (!isLoggedIn || !token) {
                alert('Please log in to add categories.');
                console.log('Add category failed: Not logged in or no token');
                return;
            }

            const name = document.getElementById('categoryName').value.trim();
            const description = document.getElementById('categoryDesc').value.trim();

            if (!name || !description) {
                alert('Please fill in both category name and description.');
                console.log('Add category failed: Missing fields', { name, description });
                return;
            }

            console.log('Adding category:', { name, description });
            try {
                const response = await fetch('http://localhost:3000/api/categories', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ name, description })
                });
                const data = await response.json();

                if (response.ok) {
                    console.log('Category added successfully:', data);
                    loadCategories();
                    document.getElementById('categoryName').value = '';
                    document.getElementById('categoryDesc').value = '';
                    alert('Category added successfully!');
                } else {
                    console.log('Add category failed:', data.message);
                    alert(data.message || 'Failed to add category. Please try again.');
                }
            } catch (err) {
                console.error('Error adding category:', err);
                alert('Error adding category. Please check your connection and try again.');
            }
        }

        async function addVideo() {
            if (!isLoggedIn || !token) {
                alert('Please log in to add videos.');
                console.log('Add video failed: Not logged in or no token');
                return;
            }

            const categoryId = document.getElementById('videoCategory').value.trim();
            const title = document.getElementById('videoTitle').value.trim();
            const url = document.getElementById('videoUrl').value.trim();
            const description = document.getElementById('videoDesc').value.trim();

            if (!categoryId || !title || !url || !description) {
                alert('Please fill in all video fields.');
                console.log('Add video failed: Missing fields', { categoryId, title, url, description });
                return;
            }

            console.log('Adding video:', { categoryId, title, url, description });
            try {
                const response = await fetch('http://localhost:3000/api/videos', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ categoryId: parseInt(categoryId), title, url, description })
                });
                const data = await response.json();

                if (response.ok) {
                    console.log('Video added successfully:', data);
                    loadCategories();
                    document.getElementById('videoCategory').value = '';
                    document.getElementById('videoTitle').value = '';
                    document.getElementById('videoUrl').value = '';
                    document.getElementById('videoDesc').value = '';
                    alert('Video added successfully!');
                } else {
                    console.log('Add video failed:', data.message);
                    alert(data.message || 'Failed to add video. Please try again.');
                }
            } catch (err) {
                console.error('Error adding video:', err);
                alert('Error adding video. Please check your connection and try again.');
            }
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
